;!function(require, directRequire){;"use strict";const tslib_1=require("tslib"),React=require("react"),cssConfig=require('./3b5f8e2469c474c8d433c1c6926d8999.js'),PickerRing=require('./59394b696f4be6762ad2b2bf3e1575a7.js'),locales=require('./common/locales/index.js'),MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"],formatNumber=(a)=>{return 9<a?""+a:"0"+a};let DateRing=class extends React.Component{constructor(a){super(a),this.onYearSelect=(a)=>{let b=a;const c=this.validDate(b,this.state.monthCurrent,this.state.dayCurrent);if(c.getTime()<this.range.start){const a=new Date(this.range.start);b=a.getFullYear()-1900,this.yearPicker.setCurrent(b),this.monthPicker.setCurrent(a.getMonth()),this.dayPicker.setCurrent(a.getDate()-1)}else if(c.getTime()>this.range.end){const a=new Date(this.range.end);b=a.getFullYear()-1900,this.yearPicker.setCurrent(b),this.monthPicker.setCurrent(a.getMonth()),this.dayPicker.setCurrent(a.getDate()-1)}this.setState({yearCurrent:b})},this.onMonthSelect=(a)=>{let b=a;const c=this.validDate(this.state.yearCurrent,b,this.state.dayCurrent);if(c.getTime()<this.range.start){const a=new Date(this.range.start);b=a.getMonth(),this.monthPicker.setCurrent(b),this.dayPicker.setCurrent(a.getDate()-1)}else if(c.getTime()>this.range.end){const a=new Date(this.range.end);b=a.getMonth(),this.monthPicker.setCurrent(b),this.dayPicker.setCurrent(a.getDate()-1)}this.setState({monthCurrent:b})},this.onDaySelect=(a)=>{let b=a;const c=this.validDate(this.state.yearCurrent,this.state.monthCurrent,b);b=c.getDate()-1,c.getTime()<this.range.start?(b=new Date(this.range.start).getDate()-1,this.dayPicker.setCurrent(b)):c.getTime()>this.range.end&&(b=new Date(this.range.end).getDate()-1,this.dayPicker.setCurrent(b)),this.setState({dayCurrent:b})};const b=new Date;this.state={yearCurrent:b.getFullYear()-1900,monthCurrent:b.getMonth(),dayCurrent:b.getDate()-1},this.range={start:0,end:Date.now()};const c="zh"===locales.getLocale();this.yearArray=[];for(let b=1900;2100>=b;b++)this.yearArray.push(b+(c?"\u5E74":""));this.monthArray=[];for(let b=1;13>b;b++)this.monthArray.push(c?`${b.toString().padStart(2,"0")}æœˆ`:MONTHS[b-1]);this.dayArray=[];for(let b=1;32>b;b++)this.dayArray.push(b.toString().padStart(2,"0")+(c?"\u65E5":""))}componentDidMount(){this.setRange("start",this.props.start||"1970-01-01"),this.setRange("end",this.props.end||"2100-01-01"),this.setCurrent(this.props.current)}componentWillReceiveProps(a){a.show&&(a.current!==this.props.current&&this.setCurrent(a.current),a.start!==this.props.start&&this.setRange("start",a.start||"1900-01-01"),a.end!==this.props.end&&this.setRange("end",a.end||"2100-01-01"))}validDate(a,b,c){const d=new Date(`${a+1900}-${b+1}-${c+1}`),e=d.getDate()-1;return this.state.dayCurrent!==e&&(this.setState({dayCurrent:e}),this.dayPicker.setCurrent(e)),d}setRange(a,b){if(b){const c=new Date(b);"Invalid Date"!==c.toString()&&(this.range[a]=c.getTime())}}setCurrent(a){if(!a)return;let b=new Date(a+"");"Invalid Date"===b.toString()&&(b=new Date,b.getTime()<this.range.start?b=new Date(this.range.start):b.getTime()>this.range.end&&(b=new Date(this.range.end))),this.setState({yearCurrent:b.getFullYear()-1900,monthCurrent:b.getMonth(),dayCurrent:b.getDate()-1})}getValue(){let a=this.state.yearCurrent+1900+"";return"month"===this.props.fields?a=a+"-"+formatNumber(this.state.monthCurrent+1):"day"===this.props.fields&&(a=a+"-"+formatNumber(this.state.monthCurrent+1)+"-"+formatNumber(this.state.dayCurrent+1)),a}hide(){this.props.hidePicker({callbackID:this.props.callbackID,webviewID:this.props.webviewID,res:{errMsg:"showDatePickerView:cancel"}})}confirm(){this.props.hidePicker({callbackID:this.props.callbackID,webviewID:this.props.webviewID,res:{errMsg:"showDatePickerView:ok",value:this.getValue()}})}render(){const a=this.props;return React.createElement("div",{style:a.show?{}:cssConfig.displayNone},React.createElement("div",{className:"weui-mask weui-animate-fade-in",onClick:this.hide.bind(this)}),React.createElement("div",{className:"weui-picker weui-animate-slide-up"},React.createElement("div",{className:"weui-picker__hd"},React.createElement("a",{className:"weui-picker__action",onClick:this.hide.bind(this)},locales.config.CANCEL),React.createElement("a",{className:"weui-picker__action",onClick:this.confirm.bind(this)},locales.config.CONFIRM)),React.createElement("div",{className:"weui-picker__bd"},React.createElement(PickerRing,{ref:(a)=>{this.yearPicker=a},array:this.yearArray,current:this.state.yearCurrent,onPickerSelect:this.onYearSelect}),React.createElement(PickerRing,{ref:(a)=>{this.monthPicker=a},hidden:"year"===a.fields,array:this.monthArray,current:this.state.monthCurrent,onPickerSelect:this.onMonthSelect}),React.createElement(PickerRing,{ref:(a)=>{this.dayPicker=a},hidden:"day"!==a.fields,array:this.dayArray,current:this.state.dayCurrent,onPickerSelect:this.onDaySelect}))))}};DateRing=tslib_1.__decorate([locales.mixin],DateRing),module.exports=DateRing;
;}(require("lazyload"), require);
