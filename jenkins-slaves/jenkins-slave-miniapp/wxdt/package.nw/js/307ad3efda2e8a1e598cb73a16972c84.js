;!function(require, directRequire){;"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),fs=require("fs"),path=require("path"),React=require("react"),react_1=require("react"),classNames=require("classnames"),locales=require('./common/locales/index.js'),CompileType=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),ContextMenuDropdown=require('./0c3c9007e8a81c513edeb550733e4fab.js'),minicode=require('./956b6e121951d375a14c73d3418eaf77.js'),libpack=require('./da189bc919cfd050066ec695411cbcf5.js'),C=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),log=require('./72653d4b93cdd7443296229431a7aa9a.js'),report=require('./da7c31daaf542cf1796023d8e344b98a.js'),topTools=require('./84b183688a46c9e2626d3e6f83365e13.js'),tools=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),request=require('./15ba1827c7f6564a45df6bd44da3a977.js'),urlConfig=require('./f171257bbcaef547a3cf27266ccb0db2.js'),dirConfig=require('./92320c1386e6db6a6f2556736a9bc280.js'),weappConfig=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),projectManager=require('./3bfffbe88b3d923921f851c0697974fe.js'),tcbApi=require('./3e74bc0c6a5fa450386148788cc0cf44.js'),projectConfigJsonUtil=require('./42191d95974f14b18961c9f2c730464e.js'),vendorManager=require('./d28a711224425b00101635efe1034c99.js'),mkdir=require("mkdir-p"),{DEV_INVALID_APPID,DEV_APP_NOT_BAND}=require('./df6d0ff021a69fb541c733de4dbba0fe.js'),{default_weapp_header,default_tourist_weapp_header}=require('./5498e660c05c574f739a28bd5d202cfa.js'),isMac="darwin"===process.platform;var ProjectType;(function(e){e.MiniProgram="miniprogram",e.MiniGame="minigame",e.MiniCode="minicode"})(ProjectType=exports.ProjectType||(exports.ProjectType={}));var Mode;(function(e){e.Select="select",e.Manage="manage",e.Create="create",e.Import="import"})(Mode=exports.Mode||(exports.Mode={}));var CloudService;(function(e){e.None="none",e.MiniCloud="minicloud",e.TencentCloud="tencentcloud"})(CloudService=exports.CloudService||(exports.CloudService={}));var QCloudRuntime;(function(e){e.NodeJS="NodeJS",e.PHP="PHP"})(QCloudRuntime=exports.QCloudRuntime||(exports.QCloudRuntime={}));var Language;(function(e){e.JavaScript="JavaScript",e.TypeScript="TypeScript"})(Language=exports.Language||(exports.Language={}));var ErrorLoc;(function(e){e[e.None=0]="None",e[e.Unknown=1]="Unknown",e[e.AppID=2]="AppID",e[e.ProjectPath=3]="ProjectPath",e[e.ProjectName=4]="ProjectName",e[e.MiniCodeLink=5]="MiniCodeLink"})(ErrorLoc=exports.ErrorLoc||(exports.ErrorLoc={}));var MINICODE_IMPORT_STATUS;(function(e){e[e.FILL_FORM=0]="FILL_FORM",e[e.PENDING=1]="PENDING",e[e.SUCCESS=2]="SUCCESS",e[e.ERROR=3]="ERROR"})(MINICODE_IMPORT_STATUS||(MINICODE_IMPORT_STATUS={}));const DEV_MODE_MINI_PROGRAM_DROPDOWN_ITEM={type:C.DEV_MODE.MINI_PROGRAM,get name(){return locales.config.MINI_PROGRAM}},DEV_MODE_MINI_GAME_DROPDOWN_ITEM={type:C.DEV_MODE.MINI_GAME,get name(){return locales.config.MINI_GAME}},DEV_MODE_PLUGIN_DROPDOWN_ITEM={type:C.DEV_MODE.PLUGIN,get name(){return locales.config.PLUGIN}},DEV_MODE_SELECTIONS={[ProjectType.MiniProgram]:[DEV_MODE_MINI_PROGRAM_DROPDOWN_ITEM,DEV_MODE_PLUGIN_DROPDOWN_ITEM],[ProjectType.MiniGame]:[DEV_MODE_MINI_GAME_DROPDOWN_ITEM],[ProjectType.MiniCode]:[DEV_MODE_MINI_PROGRAM_DROPDOWN_ITEM,DEV_MODE_MINI_GAME_DROPDOWN_ITEM,DEV_MODE_PLUGIN_DROPDOWN_ITEM]},QCLOUD_RUNTIME_SELECTIONS=[QCloudRuntime.NodeJS,QCloudRuntime.PHP],LANGUAGE_SELECTIONS=[Language.JavaScript,Language.TypeScript],QUICKSTART_CONSTRAINTS={[C.QUICKSTART_TYPE.WEAPP]:{projectType:[ProjectType.MiniProgram],mode:[C.DEV_MODE.MINI_PROGRAM]},[C.QUICKSTART_TYPE.WEAPP_MINI]:{projectType:[ProjectType.MiniCode],mode:[C.DEV_MODE.MINI_PROGRAM]},[C.QUICKSTART_TYPE.WEAPP_TS]:{projectType:[ProjectType.MiniProgram],mode:[C.DEV_MODE.MINI_PROGRAM],language:[Language.TypeScript]},[C.QUICKSTART_TYPE.GAME]:{projectType:[ProjectType.MiniGame],mode:[C.DEV_MODE.MINI_GAME]},[C.QUICKSTART_TYPE.GAME_MINI]:{projectType:[ProjectType.MiniCode],mode:[C.DEV_MODE.MINI_GAME]},[C.QUICKSTART_TYPE.PLUGIN]:{projectType:[ProjectType.MiniProgram],mode:[C.DEV_MODE.PLUGIN]},[C.QUICKSTART_TYPE.PLUGIN_MINI]:{projectType:[ProjectType.MiniCode],mode:[C.DEV_MODE.PLUGIN]},[C.QUICKSTART_TYPE.WX_CLOUD]:{projectType:[ProjectType.MiniProgram,ProjectType.MiniGame],mode:[C.DEV_MODE.MINI_PROGRAM],cloudService:[CloudService.MiniCloud]},[C.QUICKSTART_TYPE.WX_CLOUD_GAME]:{projectType:[ProjectType.MiniGame],mode:[C.DEV_MODE.MINI_GAME],cloudService:[CloudService.MiniCloud]},[C.QUICKSTART_TYPE.QCLOUD_NODEJS]:{projectType:[ProjectType.MiniProgram],mode:[C.DEV_MODE.MINI_PROGRAM],cloudService:[CloudService.TencentCloud],qcloudRuntime:[QCloudRuntime.NodeJS]},[C.QUICKSTART_TYPE.QCLOUD_NODEJS_GAME]:{projectType:[ProjectType.MiniGame],mode:[C.DEV_MODE.MINI_GAME],cloudService:[CloudService.TencentCloud],qcloudRuntime:[QCloudRuntime.NodeJS]},[C.QUICKSTART_TYPE.QCLOUD_PHP]:{projectType:[ProjectType.MiniProgram],mode:[C.DEV_MODE.MINI_PROGRAM],cloudService:[CloudService.TencentCloud],qcloudRuntime:[QCloudRuntime.PHP]},[C.QUICKSTART_TYPE.QCLOUD_PHP_GAME]:{projectType:[ProjectType.MiniGame],mode:[C.DEV_MODE.MINI_GAME],cloudService:[CloudService.TencentCloud],qcloudRuntime:[QCloudRuntime.PHP]}},QUICKSTART_MAPPING={[ProjectType.MiniProgram]:{[C.DEV_MODE.MINI_PROGRAM]:{[CloudService.None]:C.QUICKSTART_TYPE.WEAPP,[CloudService.MiniCloud]:C.QUICKSTART_TYPE.WX_CLOUD,[CloudService.TencentCloud]:{[QCloudRuntime.NodeJS]:C.QUICKSTART_TYPE.QCLOUD_NODEJS,[QCloudRuntime.PHP]:C.QUICKSTART_TYPE.QCLOUD_PHP}},[C.DEV_MODE.PLUGIN]:C.QUICKSTART_TYPE.PLUGIN},[ProjectType.MiniGame]:{[C.DEV_MODE.MINI_GAME]:{[CloudService.None]:C.QUICKSTART_TYPE.GAME,[CloudService.MiniCloud]:C.QUICKSTART_TYPE.WX_CLOUD_GAME,[CloudService.TencentCloud]:{[QCloudRuntime.NodeJS]:C.QUICKSTART_TYPE.QCLOUD_NODEJS_GAME,[QCloudRuntime.PHP]:C.QUICKSTART_TYPE.QCLOUD_PHP_GAME}}},[ProjectType.MiniCode]:{[C.DEV_MODE.MINI_PROGRAM]:C.QUICKSTART_TYPE.WEAPP_MINI,[C.DEV_MODE.MINI_GAME]:C.QUICKSTART_TYPE.GAME_MINI,[C.DEV_MODE.PLUGIN]:C.QUICKSTART_TYPE.PLUGIN_MINI}},DEFAULT_ATTR_INFO={network:{RequestDomain:[],WsRequestDomain:[],UploadDomain:[],DownloadDomain:[]},setting:Object.assign({},weappConfig.setting)},noop=()=>{};let CreateProject=class extends react_1.Component{constructor(e){super(e),this._requestingSandboxAccount=!1,this._sandboxCachedAppid={miniprogram:"",minigame:""},this.appList=[],this.devModeInput=null,this.qcloudRuntimeInput=null,this.typescriptInput=null,this.appidInput=null,this.onAppIDInputChange=(t)=>{this.changeAppID(t.target.value.trim())},this.changeAppID=async(e)=>{this.setState({appid:e,errorLoc:ErrorLoc.AppID===this.state.errorLoc?ErrorLoc.None:this.state.errorLoc,errorMsg:ErrorLoc.AppID===this.state.errorLoc?"":this.state.errorMsg}),this.refreshWithAppID(e)},this.refreshWithAppID=async(e)=>{const t=DEV_MODE_SELECTIONS[this.props.type][this.state.devModeDropdown.selected].type,o=await projectManager.getAttrByAppid(e);if(o.isSandbox){const e=o.gameApp?"minigame":"miniprogram";this._sandboxCachedAppid[e]||this.fetchSandboxAccount(e).then((t)=>{this._sandboxCachedAppid[e]=t})}if(this.props.type!==ProjectType.MiniCode||this.props.entrance[this.props.type].mode!==Mode.Import){if(t!==C.DEV_MODE.MINI_GAME&&o.gameApp)return void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.ENTER_MINI_PROGRAM_APPID_NOTICE});if(t===C.DEV_MODE.MINI_GAME&&!o.gameApp)return void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.ENTER_MINI_GAME_APPID_NOTICE})}let r=!1;try{r=(await tcbApi.getQBaseInfo(e)).open}catch(e){}this.setState({cloudService:r?CloudService.MiniCloud:CloudService.None,errorLoc:this.state.errorLoc===ErrorLoc.AppID?ErrorLoc.None:this.state.errorLoc,errorMsg:this.state.errorLoc===ErrorLoc.AppID?"":this.state.errorMsg})},this.fetchSandboxAccount=async(e)=>{if(!this._requestingSandboxAccount){this._requestingSandboxAccount=!0;try{const{body:t}=await request({url:urlConfig.getSandboxAccountUrl+"?tab="+e,needToken:1,needParse:1,method:"get",data:{tab:e}});this._requestingSandboxAccount=!1;const o=(t||{}).ret_code;if(o&&"0"!==o)throw new Error("ret code "+o);const r=(t||{}).appid||"";if(!r)throw new Error("Empty AppID");return r}catch(t){throw this._requestingSandboxAccount=!1,t}}},this.fillSandbox=async(e)=>{if(!this._sandboxCachedAppid[e])try{this._sandboxCachedAppid[e]=await this.fetchSandboxAccount(e)}catch(t){return void this.setState({fetchSandboxFailed:!0,errorMsg:t.toString&&t.toString()||`${t}`,errorLoc:ErrorLoc.AppID})}this.setState({appid:this._sandboxCachedAppid[e],errorLoc:this.state.errorLoc===ErrorLoc.AppID?ErrorLoc.None:this.state.errorLoc,errorMsg:this.state.errorLoc===ErrorLoc.AppID?"":this.state.errorMsg}),this.changeAppID(this._sandboxCachedAppid[e])},this.fillSandboxMiniprogram=async()=>{return this.fillSandbox("miniprogram")},this.fillSandboxMinigame=async()=>{return this.fillSandbox("minigame")},this.fillMiniProgramTourist=()=>{this.setState({appid:C.TOURIST_APPID,errorLoc:ErrorLoc.None})},this.fillMiniGameTourist=()=>{this.setState({appid:C.GAME_TOURIST_APPID,errorLoc:ErrorLoc.None})},this.resetAppID=()=>{this.setState({appid:""})},this.onProjectNameChange=(t)=>{this.setState({projectName:t.target.value,errorLoc:this.state.errorLoc===ErrorLoc.ProjectName?ErrorLoc.None:this.state.errorLoc,errorMsg:this.state.errorLoc===ErrorLoc.ProjectName?"":this.state.errorMsg})},this.onProjectPathChange=(t)=>{this.setState({projectPath:t.target.value,projectName:this.state.projectName===path.basename(this.state.projectPath)?path.basename(t.target.value):this.state.projectName,errorLoc:this.state.errorLoc===ErrorLoc.ProjectPath?ErrorLoc.None:this.state.errorLoc,errorMsg:this.state.errorLoc===ErrorLoc.ProjectPath?"":this.state.errorMsg,errorMsgOnClick:noop})},this.chooseDir=()=>{const e=global.contentDocumentBody,t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("nwdirectory","true"),t.style.display="none",e.appendChild(t),t.addEventListener("change",()=>{try{fs.readdirSync(t.value)}catch(t){return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:t.toString(),errorMsgOnClick:noop})}const o={projectPath:t.value};if(!(this.props.entrance[this.props.type].mode===Mode.Create)){const e=projectConfigJsonUtil.getConfigFileInfo({projectpath:t.value});e.error||(o.projectName=`${decodeURIComponent(e.config.projectname||"")}`,o.appid=e.config.isGameTourist?C.GAME_TOURIST_APPID:`${e.config.appid||""}`),this.state.errorLoc===ErrorLoc.ProjectPath&&(o.errorLoc=ErrorLoc.None)}else if(this.state.projectName===path.basename(this.state.projectPath))try{o.projectName=path.basename(t.value)}catch(e){}this.setState(o),e.removeChild(t)}),t.addEventListener("cancel",()=>{e.removeChild(t)}),t.click()},this.setCloudService=(e)=>{this.setState({cloudService:e})},this.setCloudServiceToNone=()=>{this.setCloudService(CloudService.None)},this.setCloudServiceToMiniCloud=()=>{this.setCloudService(CloudService.MiniCloud)},this.setCloudServiceToTencentCloud=()=>{this.setCloudService(CloudService.TencentCloud)},this.openDropdown=(e)=>{const t=`${e}Input`,o=this[t].getBoundingClientRect(),r=`${e}Dropdown`;this.setState({[r]:Object.assign({},this.state[r],{timestamp:+new Date,top:o.top+35,left:o.left})})},this.onDropdownItemSelected=(e,t)=>{const o=`${e}Dropdown`;this.setState({[o]:Object.assign({},this.state[o],{selected:t,timestamp:0})})},this.openDevModeDropdown=()=>{this.openDropdown("devMode")},this.onDevModeItemSelected=(e)=>{this.onDropdownItemSelected("devMode",e),this.updateAppList(this.props)},this.openQCloudRuntimeDropdown=()=>{this.openDropdown("qcloudRuntime")},this.onQCloudRuntimeItemSelected=(e)=>{this.onDropdownItemSelected("qcloudRuntime",e)},this.openTypeScriptDropdown=()=>{this.openDropdown("typescript")},this.onTypeScriptItemSelected=(e)=>{this.onDropdownItemSelected("typescript",e)},this.openAppIDDropdown=()=>{this.openDropdown("appid")},this.onAppIDItemSelected=(e,t)=>{this.onDropdownItemSelected("appid",e),this.changeAppID(t)},this.onMiniCodeLinkChange=(t)=>{this.setState({miniCodeLink:t.target.value.trim(),errorLoc:this.state.errorLoc===ErrorLoc.MiniCodeLink?ErrorLoc.None:this.state.errorLoc,errorMsg:this.state.errorLoc===ErrorLoc.MiniCodeLink?"":this.state.errorMsg})},this.onMiniCodeLinkInputKeyPress=(e)=>{"Enter"===e.key&&this.fetchMiniCodeInfo()},this.setTabToCreateProject=()=>{this.props.entrance[this.props.type].mode!==Mode.Create&&(this.resetDropdowns(),this.setMode(Mode.Create))},this.setTabToImportProject=()=>{this.props.entrance[this.props.type].mode!==Mode.Import&&(this.resetDropdowns(),this.setMode(Mode.Import))},this.setMode=(e)=>{this.props.setEntrance({[this.props.type]:{mode:e}})},this.resetDropdowns=()=>{this.setState({devModeDropdown:Object.assign({},this.state.devModeDropdown,{timestamp:0}),qcloudRuntimeDropdown:Object.assign({},this.state.qcloudRuntimeDropdown,{timestamp:0}),typescriptDropdown:Object.assign({},this.state.typescriptDropdown,{timestamp:0}),appidDropdown:Object.assign({},this.state.appidDropdown,{timestamp:0})})},this.fetchMiniCodeInfo=async()=>{if(!this.state.miniCodeLink)return void this.setState({errorLoc:ErrorLoc.MiniCodeLink,errorMsg:locales.config.ENTER_INBOUND_LINK});this.setState({miniCodeImportStatus:MINICODE_IMPORT_STATUS.PENDING});try{const e=await minicode.getMiniCodeInfo(this.state.miniCodeLink);this.setState({miniCodeImportStatus:MINICODE_IMPORT_STATUS.SUCCESS,miniCodeInfo:e,projectName:e.projectName})}catch(e){e&&e.importStatus?this.setState({miniCodeImportStatus:MINICODE_IMPORT_STATUS.ERROR,errorLoc:e.errorLoc,errorMsg:e.errorMsg}):e&&1===e.errcode?this.setState({miniCodeImportStatus:MINICODE_IMPORT_STATUS.ERROR,errorLoc:ErrorLoc.MiniCodeLink,errorMsg:locales.config.LINK_ID_NOT_EXIST}):this.setState({miniCodeImportStatus:MINICODE_IMPORT_STATUS.ERROR,errorLoc:ErrorLoc.MiniCodeLink,errorMsg:e.toString()})}},this.checkErrcode=(e,t)=>{return e===DEV_APP_NOT_BAND?(this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.APPID_BOUND_ERR}),nw.Shell.openExternal("https://mp.weixin.qq.com/"),log.error(`createstep.js create project error ${e}`),!1):e===DEV_INVALID_APPID?(this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.APPID_EXIST_ERR}),log.error(`createstep.js create project error ${e}`),!1):!(0!==e)||(this.setState({errorLoc:ErrorLoc.AppID,errorMsg:t||locales.config.SYSTEM_ERROR}),log.error(`createstep.js create project error ${e}`),!1)},this.getQuickStartToUse=()=>{const{appid:e}=this.state,t=this.props.entrance[this.props.type].mode,o=DEV_MODE_SELECTIONS[this.props.type][this.state.devModeDropdown.selected].type,r=QCLOUD_RUNTIME_SELECTIONS[this.state.qcloudRuntimeDropdown.selected],i=LANGUAGE_SELECTIONS[this.state.typescriptDropdown.selected];if(t===Mode.Import)return!1;const a=(e,t)=>t?-1<t.indexOf(e)?1:-Infinity:0,n={};let c=-Infinity,s=[],p=[];const d=(e)=>{log.error(`ERROR: ${e}
        scores: ${JSON.stringify(n)}
        highest scorers: ${JSON.stringify(s)}
        highest score: ${c}
        type: ${this.props.type}
        devMode: ${o}
        cloudService: ${this.state.cloudService}
        qcloudRuntime: ${r}
        language: ${i}
      `)};for(const t in QUICKSTART_CONSTRAINTS)n[t]=-Object.keys(QUICKSTART_CONSTRAINTS[t]).length,n[t]+=a(this.props.type,QUICKSTART_CONSTRAINTS[t].projectType),n[t]+=a(o,QUICKSTART_CONSTRAINTS[t].mode),this.props.type!==ProjectType.MiniCode&&this.canUseCloudService(e,o)&&(n[t]+=a(this.state.cloudService,QUICKSTART_CONSTRAINTS[t].cloudService),this.state.cloudService===CloudService.TencentCloud&&(n[t]+=a(r,QUICKSTART_CONSTRAINTS[t].qcloudRuntime))),this.props.type===ProjectType.MiniProgram&&this.state.cloudService===CloudService.None&&o===C.DEV_MODE.MINI_PROGRAM&&(n[t]+=a(i,QUICKSTART_CONSTRAINTS[t].language)),n[t]>c?(c=n[t],s=[t]):n[t]===c&&s.push(t);if(0!==c){const e=0>c?"highest score is less than 0.":"highest score is greater than 0.";d(e)}if(1===s.length)return s[0];for(const e of s)n[e]+=Object.keys(QUICKSTART_CONSTRAINTS[e]).length,n[e]>c?(c=n[e],p=[e]):n[e]===c&&p.push(e);if(1!==p.length){const e=1<p.length?"multiple final highest scorers found.":"no final highest scorer found.";d(e)}return console.log("final",c,p,s,n),p[0]},this.cancel=()=>{this.props.setEntrance({[this.props.type]:{mode:Mode.Select}})},this.confirm=async()=>{try{await this.createProject()}catch(e){this.setState({errorLoc:ErrorLoc.Unknown,errorMsg:`UNKNOWN ERROR: ${e}`})}},this.createProject=async()=>{let e=this.state.appid;const t=this.state.projectPath,o=this.state.projectName.trim(),r=encodeURIComponent(o);let i=e===C.TOURIST_APPID,a=e===C.GAME_TOURIST_APPID;const n=this.props.type===ProjectType.MiniCode,c=this.props.entrance[this.props.type].mode,s=DEV_MODE_SELECTIONS[this.props.type][this.state.devModeDropdown.selected].type,p=vendorManager.getVendorConfig(),d=p.currentLibVersion;if(this.props.type===ProjectType.MiniCode&&(s===C.DEV_MODE.PLUGIN?(!e||i||a)&&this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.CREATE_PROJECT_TIP_NO_APPID}):!e&&(s===C.DEV_MODE.MINI_PROGRAM?(e=C.TOURIST_APPID,i=!0):(e=C.GAME_TOURIST_APPID,a=!0))),!e)return void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.CREATE_PROJECT_TIP_NO_APPID});try{const t=await projectManager.getAttrByAppid(e);if(this.props.type!==ProjectType.MiniCode||this.props.entrance[this.props.type].mode!==Mode.Import){if(s===C.DEV_MODE.MINI_GAME&&!t.gameApp)return void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.ENTER_MINI_GAME_APPID_NOTICE});if(s!==C.DEV_MODE.MINI_GAME&&t.gameApp)return void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:locales.config.ENTER_MINI_PROGRAM_APPID_NOTICE})}}catch(e){if(e&&e.errcode){const t=this.checkErrcode(e.errcode);if(!t)return}else throw e}if(!o)return void this.setState({errorLoc:ErrorLoc.ProjectName,errorMsg:locales.config.CREATE_PROJECT_TIP_NO_NAME});if(!t)return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:locales.config.CREATE_PROJECT_TIP_NO_DIR,errorMsgOnClick:noop});const l=`${e}_${r}_${encodeURIComponent(t)}`,m=tools.strToHash(l);for(const e in this.props.project.list)if(this.props.project.list[e].projectpath===t)return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:locales.config.CREATE_PROJECT_TIP_DIRECTORY_EXIST.format(this.state.projectName),errorMsgOnClick:()=>{this.props.openProject(e)}});try{const e=()=>{let e=fs.readdirSync(t);return"darwin"===process.platform&&(e=e.filter((e)=>{return 0!==e.indexOf(".")})),e};if(c===Mode.Create||c===Mode.Import&&this.props.type===ProjectType.MiniCode)if(!fs.existsSync(t)){if(!fs.existsSync(path.join(t,"..")))return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:locales.config.CREATE_PROJECT_TIP_MUST_USE_EMPTY_FOLDER,errorMsgOnClick:noop});mkdir.sync(t)}else if(0!==e().length)return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:locales.config.CREATE_PROJECT_TIP_MUST_USE_EMPTY_FOLDER,errorMsgOnClick:noop});if(c===Mode.Import&&this.props.type!==ProjectType.MiniCode){const t=e();if(this.props.type===ProjectType.MiniProgram&&!t.find((e)=>"app.json"===e||"project.config.json"===e)||this.props.type===ProjectType.MiniGame&&!t.find((e)=>"game.json"===e||"project.config.json"===e))return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:locales.config.CREATE_PROJECT_TIP_MUST_USE_VALID_MINI_APP_FOLDER_TO_IMPORT.format(`${this.props.type===ProjectType.MiniGame?"game.json":"app.json"} / project.config.json`),errorMsgOnClick:noop})}}catch(t){return void this.setState({errorLoc:ErrorLoc.ProjectPath,errorMsg:t.toString(),errorMsgOnClick:noop})}const u=projectConfigJsonUtil.getConfigFileInfo({projectpath:t});let E=CompileType.weapp;(s===C.DEV_MODE.PLUGIN||!u.error&&u.config&&u.config.compileType===CompileType.plugin)&&(E=CompileType.plugin);const I=this.getQuickStartToUse(),M=async(e)=>{try{return e.shareInfo={from:{codeid:this.state.miniCodeInfo.miniCodeID,desc:this.state.miniCodeInfo.projectDesc,minLib:this.state.miniCodeInfo.minLibVersion,needAppID:this.state.miniCodeInfo.needAppID,importTime:+new Date}},await this.importMiniCode(t)}catch(e){return this.setState({errorLoc:ErrorLoc.MiniCodeLink,errorMsg:locales.config.CODE_PACKAGE_EXTRACT_FAIL.format(e)}),!1}};if(i){const o={projectid:l,hash:m,appid:e,projectname:r,projectpath:t,isAdmin:!1,isTourist:!0,isMiniCode:this.props.type===ProjectType.MiniCode,urlCheck:!1,compileType:E,libVersion:d,attr:Object.assign({},DEFAULT_ATTR_INFO)};if(n&&c===Mode.Import){const e=await M(o);if(!e)return}this.props.createProjectSuccess(o,{initQuickStart:I}),this.props.openProject(l),report(`project_createsuc`,e),o.compileType===CompileType.plugin&&report(`project_create_plugin`,e),request({url:`${urlConfig.touristCreateURL}?appid=${e}`,needToken:1}).catch((e)=>{log.error(`create tourist project error ${e}`)})}else try{const{resp:i,body:s}=await request({url:`${urlConfig.createWeappURL}?appid=${e}`,needToken:1,needCheckErrCode:1});log.info(`createstep.js create ${s}`);const p=s.baseresponse,u=p?parseInt(p.errcode,10):0,g=this.checkErrcode(u,s);if(!g)return;const C=s.app_head_img?`${s.app_head_img}/0`:default_weapp_header;let f=o;s.app_nickname&&(f=encodeURIComponent(s.app_nickname));const N={isAdmin:s.is_admin,isTourist:!1,isGameTourist:a,isMiniCode:this.props.type===ProjectType.MiniCode,projectid:l,hash:m,appid:e,projectname:r,projectpath:t,libVersion:d,compileType:E,attr:Object.assign({},DEFAULT_ATTR_INFO,{platform:!!s.is_platform,gameApp:!!s.game_app,platformNickname:s.platform_nickname||"",appName:f,appImageUrl:C})};if(n&&c===Mode.Import){const e=await M(N);if(!e)return}s.game_app&&(N.compileType=CompileType.game),N.appShowName=o,f!==o&&(N.appShowName=f),N.platform&&N.platformNickname&&(N.appShowName=N.platformNickname),this.props.createProjectSuccess(N,{initQuickStart:I}),this.props.openProject(l)}catch(t){return log.error(`create project error: ${t.toString()}`),void this.setState({errorLoc:ErrorLoc.AppID,errorMsg:t.toString()})}this.setState(this.getInitialState()),this.props.setEntrance({[this.props.entrance.tab]:{mode:Mode.Select}})},this.importMiniCode=async(e)=>{const{miniCodeInfo:t,appid:o}=this.state;if(!t)return!1;const r=path.join(dirConfig.Weappdest,`${+new Date}-minicode`);fs.writeFileSync(r,t.code,{encoding:null}),"wxapkg"===t.compressType?await libpack.wxapkgUnpack(r,e):"asar"===t.compressType?await libpack.asarUnpack(r,e):await libpack.wxapkgUnpack(r,e).catch(()=>{return libpack.asarUnpack(r,e)});try{const t=JSON.parse(fs.readFileSync(path.join(e,"project.config.json"),"utf8"));if("plugin"===t.compileType){const r=path.resolve(e,t.miniprogramRoot||".","app.json");if(fs.existsSync(r)){const e=JSON.parse(fs.readFileSync(r,"utf8"));if(e.plugins){let t=!1;for(const r in e.plugins){const i=e.plugins[r];i&&i.provider&&"dev"===i.version&&(i.provider=o,t=!0)}t&&fs.writeFileSync(r,JSON.stringify(e,null,2),"utf8")}}}}catch(e){}return!0},this.state=this.getInitialState(),this.updateAppList(e),window._createProject=this}componentDidMount(){if(this.props.type===ProjectType.MiniCode&&this.props.entrance.minicode.mode===Mode.Import){const e=this.props.entrance.minicode.options;e&&e.miniCodeLink&&e.from===C.MINI_CODE_FROM.URL_SCHEME&&this.loadMiniCodeLinkOnce(e.miniCodeLink)}}componentWillReceiveProps(e){if(this.props.project.list!==e.project.list&&this.updateAppList(e),e.type===ProjectType.MiniCode){const t=e.entrance.minicode.options,o=this.props.entrance.minicode.options;t&&t.miniCodeLink&&t.miniCodeLink!==o.miniCodeLink&&t.from===C.MINI_CODE_FROM.URL_SCHEME&&this.loadMiniCodeLinkOnce(t.miniCodeLink),this.props.entrance.minicode.mode!==Mode.Import&&e.entrance.minicode.mode===Mode.Import&&this.updateAppList(e)}}loadMiniCodeLinkOnce(e){this.setState({miniCodeLink:e},()=>{this.fetchMiniCodeInfo(),this.props.setEntrance({miniCode:{options:{miniCodeLink:""}}})})}updateAppList(e){const t=e.entrance[e.type].mode,o=DEV_MODE_SELECTIONS[e.type][this.state.devModeDropdown.selected].type,r={};for(const i in e.project.list)try{const{appid:a,accessTime:n,attr:c,projectname:s}=e.project.list[i];if(a===C.TOURIST_APPID||a===C.GAME_TOURIST_APPID)continue;if(t!==Mode.Import||e.type!==ProjectType.MiniCode)if(o===C.DEV_MODE.MINI_GAME&&!c.gameApp)continue;else if(o!==C.DEV_MODE.MINI_GAME&&c.gameApp)continue;const p=c.appName||c.appNickName&&decodeURIComponent(c.appNickName)||s&&decodeURIComponent(s)||"";r[a]?r[a].accessTime<n&&(r[a]={accessTime:n,appName:p}):r[a]={accessTime:n,appName:p}}catch(e){}this.appList=Object.keys(r).sort((e,t)=>r[t].accessTime-r[e].accessTime).slice(0,10).map((e)=>{return{appid:e,appName:r[e].appName}})}openMiniCloudDoc(){nw.Shell.openExternal("https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html")}openRegistrationPage(){nw.Shell.openExternal("https://mp.weixin.qq.com/wxopen/waregister?action=step1")}getNewProjectSuggestion(){const e=dirConfig.DefaultWorkspace;try{for(let t=1;20>=t;t++){const o=`${this.props.type}-test-${t}`,r=path.join(e,o);if(fs.existsSync(r))continue;else return{name:o,directory:r}}const t=`${this.props.type}-test-${+new Date}`;return{name:t,directory:path.join(e,t)}}catch(t){return{name:`${this.props.type}-test-1`,directory:path.join(e,`${this.props.type}-test-1`)}}}getInitialState(){const e=this.getNewProjectSuggestion();return{appid:"",projectName:e.name,projectPath:e.directory,cloudService:CloudService.None,miniCodeLink:"",fetchSandboxFailed:!1,errorLoc:ErrorLoc.None,errorMsg:"",errorMsgOnClick:()=>{},miniCodeImportStatus:MINICODE_IMPORT_STATUS.FILL_FORM,devModeDropdown:{timestamp:0,top:0,left:0,selected:0},qcloudRuntimeDropdown:{timestamp:0,top:0,left:0,selected:0},typescriptDropdown:{timestamp:0,top:0,left:0,selected:0},appidDropdown:{timestamp:0,top:0,left:0,selected:0}}}renderFormHeader(e){return React.createElement("div",{className:"dashboard-form-hd",key:"header"},React.createElement("div",{className:"ui-segmented-control",style:e.notDraggableStyle},React.createElement("div",{className:classNames({"ui-segmented-control-item":!0,"ui-segmented-control-item-active":this.props.entrance[this.props.type].mode===Mode.Create}),onClick:this.setTabToCreateProject},this.props.type===ProjectType.MiniCode?locales.config.MENU_NEW_MINI_CODE:locales.config.MENU_NEW_PROJECT),React.createElement("div",{className:classNames({"ui-segmented-control-item":!0,"ui-segmented-control-item-active":this.props.entrance[this.props.type].mode===Mode.Import}),onClick:this.setTabToImportProject},this.props.type===ProjectType.MiniCode?locales.config.MENU_IMPORT_MINI_CODE:locales.config.MENU_IMPORT_PROJECT)))}renderTouristTips(){const e=React.createElement("a",{href:"javascript:;",onClick:this.fillSandboxMiniprogram},locales.config.MINI_PROGRAM),t=React.createElement("a",{href:"javascript:;",onClick:this.fillSandboxMinigame},locales.config.MINI_GAME),o=React.createElement("a",{href:"javascript:;",onClick:this.fillSandboxMiniprogram},locales.config.TOOLBAR_TEST_ACCOUNT),r=React.createElement("a",{href:"javascript:;",onClick:this.fillSandboxMinigame},locales.config.TOOLBAR_TEST_ACCOUNT);let i,a=!1;if(this.props.type===ProjectType.MiniProgram?i=o:this.props.type===ProjectType.MiniGame?i=r:a=!0,!this.state.fetchSandboxFailed)return a?React.createElement("span",null,React.createElement("br",null),locales.config.OR_USE_TEST_ACCOUNT," ",e," / ",t):React.createElement("span",null,React.createElement("br",null),locales.config.OR_USE," ",i);const n=React.createElement("a",{href:"javascript:;",onClick:this.fillMiniProgramTourist},locales.config.MINI_PROGRAM),c=React.createElement("a",{href:"javascript:;",onClick:this.fillMiniGameTourist},locales.config.MINI_GAME),s=React.createElement("a",{href:"javascript:;",onClick:this.fillMiniProgramTourist},locales.config.TOURIST_MODE),p=React.createElement("a",{href:"javascript:;",onClick:this.fillMiniGameTourist},locales.config.TOURIST_MODE);let d;return this.props.type===ProjectType.MiniProgram?d=s:this.props.type===ProjectType.MiniGame&&(d=p),a?React.createElement("span",null,React.createElement("br",null),locales.config.OR_USE_TEST_ACCOUNT," ",e," / ",t,locales.config.OR_EXPERIENCE," ",n," / ",c):React.createElement("span",null,React.createElement("br",null),locales.config.OR_USE," ",i," ",React.createElement("br",null),locales.config.OR_EXPERIENCE," ",d)}renderProjectNameFormItem(e){return React.createElement("div",{key:"projectname",className:this.state.errorLoc===ErrorLoc.ProjectName?e.errorFormItemClassName:e.normalFormItemClassName,style:e.notDraggableStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},`${locales.config.PROJECT}${locales.config.NAME}`),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-input-box"},React.createElement("input",{type:"text",placeholder:"",className:"ui-input",onChange:this.onProjectNameChange,value:this.state.projectName}))))}renderProjectPathFormItem(e,{label:t=locales.config.DIRECTORY,placeholder:o="",editable:r=!0}={}){return React.createElement("div",{key:"projectpath",className:this.state.errorLoc===ErrorLoc.ProjectPath?e.errorFormItemClassName:e.normalFormItemClassName,style:e.notDraggableStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},t),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-selector ui-selector-primary",onMouseDown:()=>!r&&this.chooseDir()},React.createElement("input",{className:"ui-input",style:r?e.emptyStyle:{pointerEvents:"all"},placeholder:o,disabled:!r,onChange:this.onProjectPathChange,value:this.state.projectPath}),React.createElement("div",{className:"ui-selector-dropdown",onClick:()=>r&&this.chooseDir()},React.createElement("i",{className:"ui-icon-arrow-down-o"})))))}renderAppIDFormItem(e,t={}){const{errorFormItemClassName:o,normalFormItemClassName:r,appid:i,isTourist:a,isGameTourist:n}=e;return React.createElement("div",{key:"appid",className:this.state.errorLoc===ErrorLoc.AppID?o:r,style:e.notDraggableStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},"AppID"),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-selector ui-selector-primary"},React.createElement("input",{type:"text",className:"ui-input",placeholder:t.placeholder,disabled:a||n,onChange:this.onAppIDInputChange,value:i,ref:(e)=>this.appidInput=e}),React.createElement("div",{className:"ui-selector-dropdown",onClick:this.openAppIDDropdown},React.createElement("i",{className:"ui-icon-arrow-down-o"})),React.createElement(ContextMenuDropdown,{showTs:this.state.appidDropdown.timestamp,items:[{title:locales.config.USED_RECENTLY,disabled:!0,checked:!1,onClick:()=>{}},...this.appList.map((e,t)=>{return{title:`${e.appid} ${e.appName}`,disabled:this.state.appid===e.appid,checked:this.state.appid===e.appid,onClick:()=>this.onAppIDItemSelected(t,e.appid)}})],location:{top:this.state.appidDropdown.top,left:this.state.appidDropdown.left}})),React.createElement("p",{className:"ui-form-tips"},a||n?React.createElement("span",null,React.createElement("a",{href:"javascript:;",onClick:this.resetAppID},locales.config.CLICK_TO_FILL_APPID)):locales.config.IF_NO_APPID,a||n?null:React.createElement("span",null,React.createElement("a",{onClick:this.openRegistrationPage}," ",locales.config.REGISTER," "),this.renderTouristTips()))))}renderDevModeFormItem(e){const{mode:t,emptyStyle:o,displayNoneStyle:r}=e;return React.createElement("div",{key:"devmode",className:"ui-form-item ui-form-item-inline"},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},locales.config.DEV_MODE),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-selector ui-selector-primary",onClick:this.openDevModeDropdown},React.createElement("p",{className:"ui-selector-input",placeholder:"",ref:(e)=>this.devModeInput=e},this.state.devModeDropdown.selected<DEV_MODE_SELECTIONS[this.props.type].length?DEV_MODE_SELECTIONS[this.props.type][this.state.devModeDropdown.selected].name:DEV_MODE_SELECTIONS[this.props.type][0].name),React.createElement("div",{className:"ui-selector-dropdown"},React.createElement("i",{className:"ui-icon-arrow-down-o"})),React.createElement(ContextMenuDropdown,{showTs:this.state.devModeDropdown.timestamp,items:DEV_MODE_SELECTIONS[this.props.type].map((e,t)=>{return{title:e.name,disabled:this.state.devModeDropdown.selected===t,checked:this.state.devModeDropdown.selected===t,onClick:()=>this.onDevModeItemSelected(t)}}),location:{top:this.state.devModeDropdown.top,left:this.state.devModeDropdown.left}}))))}canUseCloudService(e,t){return t!==C.DEV_MODE.PLUGIN&&(!e||this._sandboxCachedAppid.miniprogram!==e&&this._sandboxCachedAppid.minigame!==e)}renderCloudServiceFormItem(e){const{devMode:t,emptyStyle:o,displayNoneStyle:r,notDraggableStyle:i}=e,a=this.state.appid,n=!this.canUseCloudService(a,t);return React.createElement("div",{key:"cloudservice",className:"ui-form-item ui-form-item-inline",style:n?r:o},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},locales.config.CLOUD_SERVICE),React.createElement("div",{className:"ui-form-controls",style:i},React.createElement("div",{className:"ui-radio-box",onClick:this.setCloudServiceToNone},React.createElement("label",{htmlFor:"",className:"ui-radio"},React.createElement("input",{type:"radio"}),React.createElement("i",{className:classNames({"ui-icon-radio":!0,"ui-icon-radio-o":this.state.cloudService===CloudService.None})}),React.createElement("span",{className:"ui-radio-text"},locales.config.USE_NO_CLOUD_SERVICE))),React.createElement("div",{className:"ui-radio-box",onClick:this.setCloudServiceToMiniCloud},React.createElement("label",{htmlFor:"",className:"ui-radio"},React.createElement("input",{type:"radio"}),React.createElement("i",{className:classNames({"ui-icon-radio":!0,"ui-icon-radio-o":this.state.cloudService===CloudService.MiniCloud})}),React.createElement("span",{className:"ui-radio-text"},locales.config.MINI_CLOUD_FULL_NAME)),React.createElement("p",{className:"ui-form-tips"},locales.config.MINI_CLOUD_INTRO," ",React.createElement("a",{href:"javascript:;",onClick:this.openMiniCloudDoc},locales.config.LEARN_MORE))),React.createElement("div",{className:"ui-radio-box",onClick:this.setCloudServiceToTencentCloud},React.createElement("label",{htmlFor:"",className:"ui-radio"},React.createElement("input",{type:"radio"}),React.createElement("i",{className:classNames({"ui-icon-radio":!0,"ui-icon-radio-o":this.state.cloudService===CloudService.TencentCloud})}),React.createElement("span",{className:"ui-radio-text"},locales.config.TENCENT_CLOUD)))))}renderQCloudRuntimeFormItem(e){const{devMode:t,mode:o,emptyStyle:r,displayNoneStyle:i,notDraggableStyle:a}=e;return React.createElement("div",{key:"qcloudruntime",className:"ui-form-item ui-form-item-inline",style:this.state.cloudService===CloudService.TencentCloud&&t!==C.DEV_MODE.PLUGIN?r:i},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},locales.config.RUNTIME_ENVIRONMENT),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-selector ui-selector-primary",onClick:this.openQCloudRuntimeDropdown},React.createElement("p",{className:"ui-selector-input",placeholder:"",ref:(e)=>this.qcloudRuntimeInput=e},QCLOUD_RUNTIME_SELECTIONS[this.state.qcloudRuntimeDropdown.selected]),React.createElement("div",{className:"ui-selector-dropdown"},React.createElement("i",{className:"ui-icon-arrow-down-o"})),React.createElement(ContextMenuDropdown,{showTs:this.state.qcloudRuntimeDropdown.timestamp,items:QCLOUD_RUNTIME_SELECTIONS.map((e,t)=>{return{title:e,disabled:this.state.qcloudRuntimeDropdown.selected===t,checked:this.state.qcloudRuntimeDropdown.selected===t,onClick:()=>this.onQCloudRuntimeItemSelected(t)}}),location:{top:this.state.qcloudRuntimeDropdown.top,left:this.state.qcloudRuntimeDropdown.left}}))))}renderTypeScriptFormItem(e){const{devMode:t,mode:o,emptyStyle:r,displayNoneStyle:i,notDraggableStyle:a}=e;return React.createElement("div",{key:"typescript",className:"ui-form-item ui-form-item-inline",style:this.props.type===ProjectType.MiniProgram&&this.state.cloudService===CloudService.None&&t===C.DEV_MODE.MINI_PROGRAM?r:i},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},locales.config.LANGUAGE),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-selector ui-selector-primary",onClick:this.openTypeScriptDropdown},React.createElement("p",{className:"ui-selector-input",placeholder:"",ref:(e)=>this.typescriptInput=e},LANGUAGE_SELECTIONS[this.state.typescriptDropdown.selected]),React.createElement("div",{className:"ui-selector-dropdown"},React.createElement("i",{className:"ui-icon-arrow-down-o"})),React.createElement(ContextMenuDropdown,{showTs:this.state.typescriptDropdown.timestamp,items:LANGUAGE_SELECTIONS.map((e,t)=>{return{title:e,disabled:this.state.typescriptDropdown.selected===t,checked:this.state.typescriptDropdown.selected===t,onClick:()=>this.onTypeScriptItemSelected(t)}}),location:{top:this.state.typescriptDropdown.top,left:this.state.typescriptDropdown.left}}))))}renderMiniCodeLinkFormItem(e){const t=this.state.miniCodeImportStatus===MINICODE_IMPORT_STATUS.PENDING?React.createElement("i",{className:"ui-icon-spinner",style:{width:7,height:7,transform:"scale(3)"}}):React.createElement("i",{className:"ui-icon-arrow-right-o",style:{width:7,height:7}});return React.createElement("div",{key:"minicodelink",className:this.state.errorLoc===ErrorLoc.MiniCodeLink?e.errorFormItemClassName:e.normalFormItemClassName,style:e.notDraggableStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},`${locales.config.LINK} ${locales.config.OR} ID`),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-input-box"},React.createElement("input",{type:"text",placeholder:"",className:"ui-input",value:this.state.miniCodeLink,onChange:this.onMiniCodeLinkChange,onKeyPress:this.onMiniCodeLinkInputKeyPress}),React.createElement("a",{className:"ui-input-opr",style:e.notDraggableStyle,onClick:this.fetchMiniCodeInfo},t))))}renderMiniCodeDescFormItem(e){return React.createElement("div",{key:"minicodedesc",className:"ui-form-item ui-form-item-inline",style:e.notDraggableStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle},`${locales.config.DESCRIPTION}`),React.createElement("div",{className:"ui-form-controls"},React.createElement("div",{className:"ui-input-box"},React.createElement("input",{type:"text",placeholder:"",className:"ui-input",disabled:!0,value:this.state.miniCodeInfo&&this.state.miniCodeInfo.projectDesc}))))}renderErrorMsgFormItem(e){let t=this.state.errorMsg;const o=t.match(/\[(.+)\]@click/);return o&&(t=[t.slice(0,o.index),React.createElement("span",null,React.createElement("a",{style:{color:"#2133ff"},onClick:this.state.errorMsgOnClick},o[1])),t.slice(o.index+o[0].length)]),React.createElement("div",{key:"errormsg",className:"ui-form-item ui-form-item-inline",style:this.state.errorLoc?e.emptyStyle:e.displayNoneStyle},React.createElement("label",{htmlFor:"",className:"ui-form-label",style:e.lineWrapStyle}),React.createElement("div",{className:"ui-form-controls"},React.createElement("p",{className:"dashboard-error-tips"},t)))}renderToolbar(e,{confirm:t=locales.config.CREATE,confirmDisabled:o=!1}={}){const{show:r,notDraggableStyle:i,displayNoneStyle:a}=e;return React.createElement("div",{key:"toolbar",className:"dashboard-toolbar",style:r?i:a},React.createElement("a",{className:"dashboard-toolbar-item"}),React.createElement("div",null,React.createElement("button",{className:"ui-button ui-button-default",onClick:this.cancel},locales.config.CANCEL),React.createElement("button",{className:"ui-button ui-button-primary",disabled:o,onClick:this.confirm},t)))}renderCreateProject(e){const{show:t,notDraggableStyle:o,displayNoneStyle:r}=e;return[React.createElement("div",{className:"dashboard-form",key:"form",style:t?o:r},this.renderFormHeader(e),React.createElement("div",{className:"dashboard-form-bd"},React.createElement("div",{className:"ui-form"},this.renderProjectNameFormItem(e),this.renderProjectPathFormItem(e),this.renderAppIDFormItem(e),this.renderDevModeFormItem(e),this.renderCloudServiceFormItem(e),this.renderQCloudRuntimeFormItem(e),this.renderTypeScriptFormItem(e),this.renderErrorMsgFormItem(e)))),this.renderToolbar(e)]}renderImportProject(e){const{show:t,notDraggableStyle:o,displayNoneStyle:r}=e;return[React.createElement("div",{className:"dashboard-form",key:"form",style:t?o:r},this.renderFormHeader(e),React.createElement("div",{className:"dashboard-form-bd"},React.createElement("div",{className:"ui-form"},this.renderProjectNameFormItem(e),this.renderProjectPathFormItem(e,{editable:!1}),this.renderAppIDFormItem(e),this.renderErrorMsgFormItem(e)))),this.renderToolbar(e,{confirm:locales.config.IMPORT})]}renderCreateMiniCode(e){const{show:t,notDraggableStyle:o,displayNoneStyle:r}=e;return[React.createElement("div",{className:"dashboard-form",key:"form",style:t?o:r},this.renderFormHeader(e),React.createElement("div",{className:"dashboard-form-bd"},React.createElement("div",{className:"ui-form"},this.renderProjectNameFormItem(e),this.renderProjectPathFormItem(e),this.renderAppIDFormItem(e,{placeholder:locales.config.MINI_CODE_APPID_PLACEHOLDER}),this.renderDevModeFormItem(e),this.renderErrorMsgFormItem(e)))),this.renderToolbar(e)]}renderImportMiniCode(e){const{show:t,notDraggableStyle:o,displayNoneStyle:r}=e,i=this.state.miniCodeInfo&&this.state.miniCodeInfo.needAppID?locales.config.SHARER_FILL_APPID:locales.config.MINI_CODE_APPID_PLACEHOLDER;return this.state.miniCodeInfo?[React.createElement("div",{className:"dashboard-form",key:"form",style:t?o:r},this.renderFormHeader(e),React.createElement("div",{className:"dashboard-form-bd"},React.createElement("div",{className:"ui-form"},this.renderMiniCodeLinkFormItem(e),this.renderMiniCodeDescFormItem(e),this.renderProjectNameFormItem(e),this.renderProjectPathFormItem(e),this.renderAppIDFormItem(e,{placeholder:i}),this.renderErrorMsgFormItem(e)))),this.renderToolbar(e,{confirm:locales.config.IMPORT})]:[React.createElement("div",{className:"dashboard-form",key:"form",style:t?o:r},this.renderFormHeader(e),React.createElement("div",{className:"dashboard-form-bd"},React.createElement("div",{className:"ui-form"},this.renderMiniCodeLinkFormItem(e),this.renderErrorMsgFormItem(e)))),this.renderToolbar(e,{confirm:locales.config.IMPORT,confirmDisabled:!0})]}render(){const e="ui-form-item ui-form-item-inline",t=`${e} ui-form-item-error`,o=this.state.appid,r=o===C.TOURIST_APPID,i=o===C.GAME_TOURIST_APPID,a=this.props.entrance[this.props.type].mode,n=DEV_MODE_SELECTIONS[this.props.type][this.state.devModeDropdown.selected].type,c=this.props.type===this.props.entrance.tab,s={show:c,normalFormItemClassName:e,errorFormItemClassName:t,displayNoneStyle:{display:"none"},emptyStyle:{},lineWrapStyle:{whiteSpace:"normal"},draggableStyle:{WebkitAppRegion:"drag"},notDraggableStyle:{WebkitAppRegion:"no-drag"},appid:o,isTourist:r,isGameTourist:i,mode:a,devMode:n};switch(this.props.type){case ProjectType.MiniProgram:case ProjectType.MiniGame:return a===Mode.Create?this.renderCreateProject(s):this.renderImportProject(s);case ProjectType.MiniCode:return a===Mode.Create?this.renderCreateMiniCode(s):this.renderImportMiniCode(s);}}};CreateProject=tslib_1.__decorate([locales.mixin],CreateProject),exports.CreateProject=CreateProject;
;}(require("lazyload"), require);
