;!function(require, directRequire){;"use strict";const path=require("path"),fs=require("fs"),os=require("os"),vendorManager=require('./d28a711224425b00101635efe1034c99.js'),contentWatcher=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),getComponentConfig=require('./e53dfc2b83456f986002c49964f30fbf.js'),locales=require('./common/locales/index.js'),compileCache=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),tools=require('./84b183688a46c9e2626d3e6f83365e13.js'),dirConfig=require('./92320c1386e6db6a6f2556736a9bc280.js'),{PLUGIN_TRANS_WXML_JS_ERR}=require('./949d8235c744ced2a80121e4dba34c28.js'),{spawn}=require("child_process");async function wxmlToJS(a,b){const c=await contentWatcher(a),d=c.srcPath,e=b.cut?"-xc":"-cc";let f=c.getAllWXMLFiles();const g=c.getAllWXSFiles();g&&0<g.length&&(f=f.concat(g));const h=await getComponentConfig.getCompileConfig(a);f=f.map((a)=>`./${a}`);const i=`$gwx_${b.pluginId}`;if(!f||0===f.length)return{code:"",name:i};const j=">_<"+Date.now()%1e4,k=["-d",e,h.join(j),"--split",j].concat(f).concat(["-p","-gn",i]),l=a.setting&&a.setting.newFeature,m=path.join(os.tmpdir(),tools.random()),n=tools.shouldUseConfigFile(k);n&&fs.writeFileSync(m,k.join("\n"));const o=vendorManager.getWXMLParsePath(l),p=spawn(o,n?["--config-path",tools.normalizePath(m)]:k,{cwd:d});return new Promise((a,b)=>{const c=[],d=[];p.on("close",(e)=>{if(n&&fs.unlinkSync(m),0===e){const b=Buffer.concat(c).toString();return a({code:b,name:i})}const f=Buffer.concat(d).toString(),g=new Error(locales.config.COMPILE_WXML_ERROR_CONSOLE);return g.code=PLUGIN_TRANS_WXML_JS_ERR,g.msgForConsole=f,b(g)}),p.stdout.on("data",(a)=>{c.push(a)}),p.stderr.on("data",(a)=>{d.push(a)})})}async function transWXMLToJS(a,b){await compileCache.init(a);const c=compileCache.CACHE_KEYS.WXML_PLUGIN,d=b.cut?"-xc":"-cc";let e=compileCache.get(c,d);return e||(e=await wxmlToJS(a,b),compileCache.set(c,d,e)),e}module.exports=transWXMLToJS;
;}(require("lazyload"), require);
