;!function(require, directRequire){;"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const request=require('./233d77ecf0781f44985f684f70e316d0.js'),fs=require("fs");function saveAs(a){return new Promise((b,c)=>{const e=document,d=e.body;let f=e.createElement("input");f.style.display="none",f.style.position="fixed",f.style.zIndex="-999",f.setAttribute("nwsaveas",a),f.setAttribute("type","file"),d.appendChild(f),f.click();const g=()=>{f&&(f.removeEventListener("change",h),f.removeEventListener("cancel",i),f.remove()),f=null},h=(a)=>{b(a.target.value||null),g()},i=()=>{c("user cancel"),g()};f.addEventListener("change",h),f.addEventListener("cancel",i)})}exports.saveAs=saveAs;function downloadFile(a){const b=request({method:"get",url:a.url,timeout:6e4});let c=-1,d=0;b.on("response",(b)=>{const d=b.statusCode;(200>d||400<=d)&&a.onError("HTTP ERROR "+d);const e=parseInt(b.headers["content-length"]||b.headers["Content-Length"],10);c=e});const e=a.filePath+".wxpart",f=()=>{try{fs.unlinkSync(e)}catch(a){console.error(a)}};b.on("error",(b)=>{f(),a.onError(b)}),b.on("data",(b)=>{d+=b.length,a.onProgress(d,c)});let g=!1,h=!1;const i=()=>{if(g&&h)if(fs.existsSync(e)){try{fs.renameSync(e,a.filePath)}catch(b){a.onError(b)}a.onSuccess(a.filePath)}else f(),a.onError("Local file not found")};b.on("end",()=>{g=!0,i()});const j=fs.createWriteStream(e);j.on("close",()=>{h=!0,i()}),b.pipe(j)}exports.downloadFile=downloadFile;
;}(require("lazyload"), require);
