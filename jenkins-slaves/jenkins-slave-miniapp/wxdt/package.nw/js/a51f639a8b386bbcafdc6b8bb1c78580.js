;!function(require, directRequire){;"use strict";const path=require("path"),vendorManager=require('./d28a711224425b00101635efe1034c99.js'),checkGameAppConfig=require('./1bd2563d13db26950ae47494b2c34454.js'),getDevtoolsConfig=require('./be8599cf60139a20dca47b3e43647454.js'),stores=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),compileCache=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),fileRules=require('./1c8a8c710417d102ab574145dc51b4b0.js'),{asDebug,subAsDebug,vendorList,devVendorList,devSubContextList,devWorkerList,subvendorList,workerVendorList,htmlTpl,asdebugPlaceholder,devtoolsConfigPlaceholder,vendorPlaceholder,canvasPlaceholder,subAsdebugPlaceholder,workerVendorPlaceholder,workerAsdebugPlaceholder,workerAsDebug,alphaVendorPlaceholder}=require('./d9ce5316cc172b6017fdd2399a91117a.js'),isDev=global.appConfig.isDev,vendors=isDev&&!nw.App.manifest.forceVendor?devVendorList:vendorList,subVendors=isDev&&!nw.App.manifest.forceVendor?devSubContextList:subvendorList,workerVendors=isDev&&!nw.App.manifest.forceVendor?devWorkerList:workerVendorList;let lastProjectSetting="";function resetCache(){compileCache.remove(compileCache.CACHE_KEYS.JS_APPSERVICE_GAME)}function hidedInDevtoolsMaker(a){const b=path.posix.join("game",a);return`<script>\n// ${a} has been hided by project.config.json\n//# sourceURL=http://127.0.0.1:${global.proxyPort}/${b}\n</script>`}async function generate(a){await compileCache.init(a);const b=compileCache.CACHE_KEYS.JS_APPSERVICE_GAME,c=(a.debugOptions||{}).hidedInDevtools||[];let d=!1;const e=getDevtoolsConfig(),f=JSON.stringify({setting:a.setting,condiction:a.condiction,devtoolsConfig:e,debugOptions:a.debugOptions});f!==lastProjectSetting&&(d=!0,lastProjectSetting=f);let g=compileCache.get(b);if(d||!g){let d=htmlTpl;d=d.replace(devtoolsConfigPlaceholder,()=>`<script charset="UTF-8">var __devtoolsConfig=${JSON.stringify(e)}</script>`),d=d.replace(asdebugPlaceholder,()=>isDev?"<script src=\"__asdebug__/asdebug.js\" charset=\"UTF-8\"></script>":`<script charset="UTF-8">${asDebug}</script>`),d=d.replace(vendorPlaceholder,()=>{const a=[];for(let b=0,d=vendors.length;b<d;b++){const d=vendors[b],e=path.extname(d);".js"===e?(a.push(`<script src="__dev__/${d}" charset="UTF-8"></script>`),fileRules.isFileHidedInDevtools(d,c)&&a.push(hidedInDevtoolsMaker(`__dev__/${d}`))):".css"===e&&a.push(`<link rel="stylesheet" type="text/css" href="__dev__/${d}" />`)}return a.join("\n")});const f=await checkGameAppConfig(a),h=f.openDataContext||f.subContext;h&&(d=d.replace(subAsdebugPlaceholder,()=>isDev?"<script src=\"__subasdebug__/subasdebug.js\" charset=\"UTF-8\"></script>":`<script charset="UTF-8">${subAsDebug}</script>`));const i=f.workers;i&&(d=d.replace(workerAsdebugPlaceholder,()=>isDev?"<script src=\"__workerasdebug__/workerasdebug.js\" charset=\"UTF-8\"></script>":`<script charset="UTF-8">${workerAsDebug}</script>`),d=d.replace(workerVendorPlaceholder,()=>{const a=[];for(let b=0,c=workerVendors.length;b<c;b++){const c=workerVendors[b],d=path.extname(c);".js"===d&&a.push(`<script src="__workerdev__/${c}" charset="UTF-8"></script>`)}const b=`<script charset="UTF-8">var __workerVendors__ = ${JSON.stringify(workerVendors)}</script>`;return b+"\n"+a.join("\n")})),f.cloud&&(d=d.replace(alphaVendorPlaceholder,()=>{const a=[alphaVendorPlaceholder,`<script src="__alphadev__/WACloud.js" charset="UTF-8"></script>`];return a.join("\n")})),d=d.replace(canvasPlaceholder,()=>{const a=stores.getState(),b=a.toolbar.deviceInfo,{screenHeight:c,screenWidth:d}=b;return`<canvas id="myCanvas" width="${d}" height="${c}" ></canvas>`}),g=d,compileCache.set(b,g)}return g}vendorManager.on("VENDOR_CONFIG_CHANGE",resetCache),vendorManager.on("VENDOR_VERSION_CHANGE",resetCache),module.exports=generate;
;}(require("lazyload"), require);
