;!function(require, directRequire){;"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),React=require("react"),{connect}=require("react-redux"),cssConfig=require('./3b5f8e2469c474c8d433c1c6926d8999.js'),simulatorActions=require('./ba23d8b47b1f4ea08b9fd49939b9443f.js'),tools=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),locales=require('./common/locales/index.js'),AUTH_STATUS_NOT_SELECT=1,AUTH_STATUS_DEFAULT_SELECT=2,AUTH_STATUS_MUST_SELECT=3,mapStateToProps=(a)=>{const b=a.simulator.authorize||{};return{show:b.show,callback:b.callback,scopeList:b.scopeList||[],imageUrl:b.imageUrl||"",appName:b.appName||""}},mapDispatchToProps=(a)=>({setAuthorize:tools.bindActionCreators(simulatorActions.setAuthorize,a)});let Authorize=class extends React.Component{constructor(a){super(a),this.handleOnAllow=()=>{this.callback(!0)},this.handleOnCancel=()=>{this.callback(!1)},this.state={scopeList:this.formateScopeList(a.scopeList)}}componentWillReceiveProps(a){a.scopeList!==this.props.scopeList&&this.setState({scopeList:this.formateScopeList(a.scopeList)})}formateScopeList(a){return a.map((a)=>{return a.checked=a.auth_state===AUTH_STATUS_MUST_SELECT||a.auth_state===AUTH_STATUS_DEFAULT_SELECT,a})}_checkboxChange(a){const b=this.state.scopeList;return()=>{b[a].checked=!b[a].checked,this.setState({scopeList:b})}}callback(a){"function"==typeof this.props.callback&&this.props.callback(a,this.state.scopeList),this.props.setAuthorize(!1)}render(){const a=this.props,b=this.state.scopeList.map((a,b)=>{if(a.auth_state===AUTH_STATUS_MUST_SELECT)return React.createElement("div",{key:a.scope,className:"weui-agree"},React.createElement("i",{className:"icon-dot"}),React.createElement("span",{className:"weui-agree__text"},a.desc,a.ext_desc));const c="authorize_checkbox"+b,d=!!a.checked;return React.createElement("label",{key:a.scope,className:"weui-agree",htmlFor:c},React.createElement("input",{id:c,type:"checkbox",className:"weui-agree__checkbox",checked:d,onChange:this._checkboxChange(b)}),React.createElement("span",{className:"weui-agree__text"},a.desc,a.ext_desc))});return React.createElement("div",{className:"auth-dialog",style:this.props.show?{}:cssConfig.displayNone},React.createElement("div",{className:"weui-mask"}),React.createElement("div",{className:"weui-dialog"},React.createElement("div",{className:"weui-dialog__hd"},React.createElement("strong",{className:"weui-dialog__title"},locales.config.WECHAT_AUTHORIZATION)),React.createElement("div",{className:"weui-dialog__bd"},React.createElement("div",{className:"auth-dialog-content"},React.createElement("div",{className:"auth-dialog-logo"},React.createElement("img",{src:a.imageUrl,alt:""})),React.createElement("div",{className:"auth-dialog-title"},locales.config.APPLY_PERMISSION.format(a.appName)),React.createElement("div",{className:"auth-dialog-list"},b))),React.createElement("div",{className:"weui-dialog__ft"},React.createElement("a",{className:"weui-dialog__btn weui-dialog__btn_default auto_test_btn_default","data-type":"authorize",onClick:this.handleOnCancel},locales.config.AUTHORIZATION_REFUSE),React.createElement("a",{className:"weui-dialog__btn weui-dialog__btn_primary auto_test_btn_primary","data-type":"authorize",onClick:this.handleOnAllow},locales.config.AUTHORIZATION_PERMIT))))}};Authorize=tslib_1.__decorate([locales.mixin],Authorize),module.exports=connect(mapStateToProps,mapDispatchToProps)(Authorize);
;}(require("lazyload"), require);
