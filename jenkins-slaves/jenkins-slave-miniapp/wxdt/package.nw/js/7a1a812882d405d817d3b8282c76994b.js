'use strict';!function(require,directRequire){const a=require('path'),b=require('source-map'),c=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),d=require('./a89be4febc57a81e9865a060f74e14c8.js'),e=require('./e53dfc2b83456f986002c49964f30fbf.js'),f=require('./80a27260d67a4c5a94011a75ea778fcb.js'),g=require('./6e1614a32b5d10964071477dd7310d21.js'),h=require('./2d8c17f8789be1869edbd369314f5eaa.js'),i=require('./503c215d003cb9646f16deee95253baf.js'),{NO_BOM_VAR:j}=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),k=require('./72653d4b93cdd7443296229431a7aa9a.js'),l=require('./91813390c7af1ab7c0fa362a5ecb48b9.js'),m=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),n=require('./d28a711224425b00101635efe1034c99.js'),o=['define','require','module','exports','global','wx','App','Page','Component','Behavior','getApp','getCurrentPages'],p=async(a,h={})=>{const{pluginId:l,version:p}=h,q=`${l}_${p}`;await m.init(a);const r=m.CACHE_KEYS.JS_APPSERVICE_PLUGIN,s=a.setting&&a.setting.nodeModules?'nodeModules':'main',t=await c(a);let u=m.get(r,s);if(u&&u.code&&u.key==q&&u.es6==a.setting.es6)return u.code;const v=[];let w=[];const x=new b.SourceMapGenerator({file:`${l}.js`});let y=0;const z=await d(a);if(w.push(`definePlugin("plugin://${l}", function(${o.join(',')}) {`),!0===z.cloud){const a=await n.getAlphaFile('WACloud.js');w.push(`\n${a}\n`)}w.push('var __wxAppCode__ = global.__wxAppCode__'),v.push(w.join(';')),y++;const A=await g(a,{cut:!0,pluginId:l,version:p});v.push(`${A.code}`),y+=A.code.split('\n').length;const B=await i(a,{wxss:!1,prefix:A.name,pluginId:l,version:p});v.push(B.join(';')),y++;const C=t.getAllJSFiles();let D={};for(let c=0,d=C.length;c<d;c++){const d=C[c];if(D[d])continue;D[d]=!0;const e=await f(a,d);if(v.push(`define("${d}", function(require, module, exports, ${j}){ "use strict";`),y++,v.push(e.code),e.map)try{const a=new b.SourceMapConsumer(e.map);x.setSourceContent(d,a.sourcesContent[0]),a.eachMapping((a)=>{x.addMapping({generated:{line:y+a.generatedLine,column:a.generatedColumn},original:{line:a.originalLine,column:a.originalColumn},source:d,name:a.name})})}catch(a){k.error(`error while running sourcemap generation for plugin code that is babelled: \n\t [file]: ${d} \n\t [error info]: ${a}`)}else if(e.code){x.setSourceContent(d,e.code);for(let a=1,b=e.code.split('\n').length;a<=b;a++)x.addMapping({generated:{line:y+a,column:0},original:{line:a,column:0},source:d})}y+=e.code.split('\n').length,v.push('})'),y++}const E=await e.getFileList(a);if(D={},w=[],E.forEach((a)=>{if(!D[a]){D[a]=!0;const b=a.replace(/\"/g,'\\"');w.push(`global.__wxAppCurrentFile__ = "plugin-private://${l}/${b}.js"`),w.push(`global.__wxRoute = "__plugin__/${l}/${b}"`),w.push('global.__wxRouteBegin = true'),w.push(`require("${a}.js")`)}}),v.push(w.join(';')),y++,z.publicComponents||z.pages){for(const a in w=[],z.publicComponents)w.push(`"plugin://${l}/${a}": "plugin-private://${l}/${z.publicComponents[a]}"`);for(const a in z.pages)w.push(`"plugin://${l}/${a}": "plugin-private://${l}/${z.pages[a]}"`);v.push(`global.publishDomainComponents({${w.join(',')}})`),y++}return z.main&&(v.push(`module.exports = function(){return require("${z.main}")}`),y++),v.push(`})
requirePlugin("plugin://${l}")
//# sourceMappingURL=appservice.js.map`),y+=2,u={key:`${l}_${p}`,es6:!!a.setting.es6,code:v.join('\n'),sourcemap:x.toString()},m.set(r,s,u),u.code};module.exports={getServiceCode:async(a,b={})=>{const{pluginId:c,version:d}=b,e=`${c}_${d}`;if(!('dev'==d)){const a=await h.getCode(c,d);return a['/appservice.js']}else if(c==a.appid)return await p(a,b)},getServiceCodeMap:async(a,b={})=>{const{pluginId:c,version:d}=b;if('dev'==d&&c==a.appid){const b=`${c}_${d}`;await m.init(a);const e=m.CACHE_KEYS.JS_APPSERVICE_PLUGIN,f=a.setting&&a.setting.nodeModules?'nodeModules':'main',g=m.get(e,f);if(g&&g.code&&g.key==b&&g.es6==a.setting.es6)return g.sourcemap}return''}}}(require('lazyload'),require);