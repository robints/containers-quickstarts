;!function(require, directRequire){;'use strict';const path=require('path'),locales=require('./common/locales/index.js'),appErrcodeConfig=require('./949d8235c744ced2a80121e4dba34c28.js'),checkExtJSON=require('./551bb965e1f344281d555a429cd2140c.js'),checkAppJSON=require('./8267de7f4ec7b70a147f3fa5ef2bdea4.js'),contentWatcher=require('./162bf2ee28b76d3b3d95b685cede4146.js'),tools=require('./84b183688a46c9e2626d3e6f83365e13.js'),checkNodeModules=require('./fcadebce92dacc42ac4bba476b700dee.js'),compileCache=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),commonChecker=require('./464e9598eb5c203da6b41e702e422c70.js'),parseErr=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),T=directRequire('./8a667b7a4c0cf964060daa2612e47d49.js'),validateType=directRequire('./2bf4b152a123cbd45f6c373678160abb.js');async function checkPageJSON(a,b){const c=`${b}.json`;await compileCache.init(a);const d=await contentWatcher(a),e=compileCache.CACHE_KEYS.JSON_FILE,f=path.posix.join(d.srcPath,c),g=compileCache.get(e,f);if(g&&g.code&&g.nodeModules===a.setting.nodeModules)return g.code;let h={},i='{}';try{i=d.getFile(c)}catch(a){}try{h=JSON.parse(i)}catch(a){const d=parseErr.parseJsonParseErr({fileName:c,data:i,error:a}),e=new Error(d);throw e.path=b,e.code=appErrcodeConfig.PAGES_JSON_PARSE_ERR,e}try{validateType.check(h)}catch(a){const c=new Error(`${b}.json: pageJSON${a.message}`);throw c.path=b,c.code=appErrcodeConfig.PAGES_JSON_PARSE_ERR,c}const j=T.invalidKeys(validateType,h);if(j){const a=j.map((a)=>{return`pageJSON(${b})${a}`});h.__warning__=locales.config.INVALID.format(a.join('\u3001'))}const k=await checkExtJSON(a);k&&k.extPages&&k.extPages[b]&&(h=Object.assign({},h,k.extPages[b]));const l=[];if(h.backgroundColorTop&&(h.backgroundColor=h.backgroundColorTop),h.usingComponents&&commonChecker.checkUsingComponents(h,{msg:l,filePath:b,JSON_PARSE_ERR:appErrcodeConfig.PAGES_JSON_PARSE_ERR}),0<l.length){const a=new Error(l.join('\n'));throw a.path=b,a.code=appErrcodeConfig.PAGES_JSON_PARSE_ERR,a}const m=await checkAppJSON(a);if(m.usingComponents&&!b.startsWith('miniprogram_npm'))for(const c in h.usingComponents||(h.usingComponents={}),m.usingComponents){if(h.usingComponents[c])continue;const e=m.usingComponents[c]||'',f=a.miniprogramRoot?tools.normalizePath(a.miniprogramRoot):'.',g=a.miniprogramRoot?path.join(a.projectpath,f):a.projectpath;if(!e.startsWith('/')&&!e.startsWith('plugin://')){const a=path.resolve(g,e),i=path.dirname(path.resolve(g,b)),j=path.relative(i,a);if(e.startsWith('.'))h.usingComponents[c]=tools.normalizePath(j);else if(!d.exists(a)){const a=await checkNodeModules.resolveComponentPath(d,f,e);h.usingComponents[c]=a?tools.normalizePath(path.relative(b,a)):tools.normalizePath(j)}else h.usingComponents[c]=tools.normalizePath(j)}else h.usingComponents[c]=m.usingComponents[c]}return a.setting&&a.setting.nodeModules&&(await checkNodeModules.checkComponentPath(d,h,b)),compileCache.set(e,f,{code:h,nodeModules:a.setting.nodeModules}),h}module.exports=checkPageJSON;
;}(require("lazyload"), require);
