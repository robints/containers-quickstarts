'use strict';!function(require,directRequire){function a(b,c){const d=new Set(Object.keys(b.package&&b.package.dependencies||{})),e=[];for(let a=b;a;){const b=a.children||[];for(let a of b){const b=a.package&&a.package.name||'';d.has(b)&&(d.delete(b),e.push(a))}a=a.parent}for(const d of e)c.has(d)||(c.add(d),a(d,c))}async function b(b){return new Promise((c,e)=>{d(b,(b,d)=>{if(b)return e(b);const f=new Set;try{a(d,f)}catch(a){return e(a)}c(Array.from(f))})})}const c=require('path'),d=require('read-package-tree');module.exports=async function(a,d){if(d&&d.length){const e=d.filter((a)=>!/([\\\/]|\b)node_modules/.test(a)),f=[],g={};for(const d of e){const e=await b(c.join(a,c.dirname(d)));e.forEach((a)=>f.push(a))}for(const a of f){const b=a.isLink?a.path:a.realpath;g[c.normalize(c.join(b,'./package.json'))]=a}d=d.filter((b)=>{const d=c.normalize(c.join(a,b));return!!g[d]})}return d}}(require('lazyload'),require);