;!function(require, directRequire){;"use strict";const path=require("path"),os=require("os"),fs=require("fs"),{spawn}=require("child_process"),{TRANS_WXSS_JS_ERR}=require('./949d8235c744ced2a80121e4dba34c28.js'),locales=require('./common/locales/index.js'),tools=require('./84b183688a46c9e2626d3e6f83365e13.js'),vendorManager=require('./d28a711224425b00101635efe1034c99.js'),contentWatcher=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),getComponentConfig=require('./e53dfc2b83456f986002c49964f30fbf.js'),compileCache=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),wxssParserPath=vendorManager.getWXSSParsePath();async function wxssToJS(a){const b=await contentWatcher(a),c=b.getAllWXSSFiles(),d=b.srcPath,e=await getComponentConfig.getFileList(a);let f=0;const g=[],h={};for(const b in c.forEach((a)=>{h[a]=!0}),e.forEach((a)=>{h[`${a}.wxss`]&&(f++,g.push(`./${a}.wxss`),delete h[`${a}.wxss`])}),h)g.push(`./${b}`);const i=["-db","-pc",f].concat(g),j=path.join(os.tmpdir(),tools.random()),k=tools.shouldUseConfigFile(i);k&&fs.writeFileSync(j,i.join("\n"));const l=spawn(wxssParserPath,k?["--config-path",tools.normalizePath(j)]:i,{cwd:d});return new Promise((a,b)=>{const c=[],d=[];l.on("close",(e)=>{if(k&&fs.unlinkSync(j),0===e){const b=Buffer.concat(c).toString(),d=b.split("="),e={};for(let a=0,b=d.length;a<b&&d[a+1];a+=2)e[d[a]]=d[a+1];return a(e)}const f=Buffer.concat(d).toString(),g=new Error(locales.config.COMPILE_WXSS_ERROR_CONSOLE);return g.code=TRANS_WXSS_JS_ERR,g.msgForConsole=f,b(g)}),l.stdout.on("data",(a)=>{c.push(a)}),l.stderr.on("data",(a)=>{d.push(a)})})}async function transWXSSToJS(a,b){await compileCache.init(a);const c=compileCache.CACHE_KEYS.WXSS_PLUGIN;let d=compileCache.get(c);if(d||(d=await wxssToJS(a),compileCache.set(c,d)),!d)return"";const{app:e,page:f}=b;return e?d.comm:d[`./${f}.wxss`]||""}module.exports=transWXSSToJS;
;}(require("lazyload"), require);
